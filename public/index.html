<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>All Projects</title>
    <!-- Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-gray-100 min-h-screen flex flex-col items-center p-6">
    <h1 class="text-3xl font-bold mb-6">All Projects</h1>
    <a href="/admin-dashboard" class="text-blue-600 hover:underline">Dashboard</a>

    <div id="project-list" class="w-full max-w-4xl space-y-4">
      <!-- Projects will be injected here -->
    </div>

    <script>
      async function loadProjects() {
        try {
          const res = await fetch("/api/v1/projects");
          if (!res.ok) throw new Error(`HTTP ${res.status}`);

          const result = await res.json(); // { success, count, data }
          const projects = result.data;

          const list = document.getElementById("project-list");
          list.innerHTML = "";

          if (!projects || projects.length === 0) {
            list.innerHTML =
              '<p class="text-gray-500 text-center">No projects found.</p>';
            return;
          }

          projects.forEach((p) => {
            const card = document.createElement("div");
            card.className =
              "bg-white p-6 rounded-lg shadow hover:shadow-md transition-shadow";

            card.innerHTML = `
            <h2 class="text-xl font-semibold mb-2">${p.title}</h2>
            <p class="text-gray-700 mb-3">${p.description || "No description"}</p>
            <div class="text-sm text-gray-500 mb-2">
              Category: ${p.category || "N/A"} | Views: ${p.viewsCount || 0}
            </div>
            <div class="text-sm  font-semibold px-2 py-1 rounded ${getStatusColor(p.status)}">
  ${p.status || "N/A"}
</div>

            <div class="flex space-x-4">
              ${p.liveUrl ? `<a href="${p.liveUrl}" target="_blank" class="text-blue-600 hover:underline">Live</a>` : ""}
              ${p.codeUrl ? `<a href="${p.codeUrl}" target="_blank" class="text-blue-600 hover:underline">Code</a>` : ""}
            </div>
          `;

            list.appendChild(card);
          });
        } catch (err) {
          console.error("Error fetching projects:", err);
          document.getElementById("project-list").innerHTML =
            '<p class="text-red-500 text-center">Error loading projects.</p>';
        }
      }
      function getStatusColor(status) {
        switch (status.toLowerCase()) {
          case "planning":
            return "bg-yellow-200 text-yellow-800";
          case "active":
            return "bg-green-200 text-green-800";
          case "completed":
            return "bg-blue-200 text-blue-800";
          case "archived":
            return "bg-gray-200 text-gray-800";
          default:
            return "bg-gray-100 text-gray-700";
        }
      }

      loadProjects();
    </script>
  </body>
</html>
